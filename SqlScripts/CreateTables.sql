 CREATE TABLE [BTUsers] ( [Id] INT PRIMARY KEY, [StringId] NVARCHAR (450) DEFAULT NULL, [UserName] VARCHAR(40) DEFAULT NULL, [FirstName] VARCHAR(20), [LastName] VARCHAR(20), [Role] INT DEFAULT 7, [Administrator] INT DEFAULT NULL, FOREIGN KEY([Administrator]) REFERENCES [BTUsers]([Id]) ON DELETE NO ACTION ); CREATE TABLE [Projects] ( [Id] INT PRIMARY KEY, [Title] VARCHAR(255), [Owner] INT, FOREIGN KEY([Owner]) REFERENCES [BTUsers]([Id]) ON DELETE SET NULL ); CREATE TABLE [Assignments]( [UserAssigned] INT, [ProjectId] INT, PRIMARY KEY([UserAssigned], [ProjectId]), FOREIGN KEY([UserAssigned]) REFERENCES [BTUsers]([Id]) ON DELETE CASCADE, FOREIGN KEY([ProjectId]) REFERENCES [Projects]([Id]) ON DELETE CASCADE ); CREATE TABLE [Tickets]( [ProjectParent] INT, [Id] INT UNIQUE, [HistoryId] INT, [IsCurr] BIT NOT NULL DEFAULT 0, [Title] VARCHAR(255), [Severity] INT, [Status] INT, [UnwantedBehavior] VARCHAR(1023), [RepeatableSteps] VARCHAR(1023), [OpenedBy] INT, [DateCreated] DATETIME, PRIMARY KEY([ProjectParent], [Id]), FOREIGN KEY([ProjectParent]) REFERENCES [Projects]([Id]) ON DELETE CASCADE, FOREIGN KEY([OpenedBy]) REFERENCES [BTUsers]([Id]) ON DELETE SET NULL ); CREATE TABLE [ClosedTickets]( [ProjectParent] INT, [TicketClosed] INT, [UnwantedBehaviorCause] VARCHAR(1023), [UnwantedBehaviorSolution] VARCHAR(1023), [IsTemp] BIT NOT NULL DEFAULT 0, [DateClosed] DATETIME, [UserWhoClosed] INT, PRIMARY KEY([ProjectParent], [TicketClosed]), FOREIGN KEY([ProjectParent]) REFERENCES [Projects]([Id]) ON DELETE NO ACTION, FOREIGN KEY([TicketClosed]) REFERENCES [Tickets]([Id]) ON DELETE CASCADE, FOREIGN KEY([UserWhoClosed]) REFERENCES [BTUsers]([Id]) ON DELETE SET NULL ); CREATE TABLE [Comments]( [Id] INT, [Owner] INT, [TicketId] INT, [Msg] VARCHAR(255), [DateCreated] DATETIME, PRIMARY KEY ([Id]), FOREIGN KEY ([Owner]) REFERENCES [BTUsers]([Id]) ON DELETE CASCADE, FOREIGN KEY ([TicketId]) REFERENCES [Tickets]([Id]) ON DELETE CASCADE );